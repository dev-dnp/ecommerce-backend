generator client {
  provider = "prisma-client"
  output   = "../generated/prisma"
}

datasource db {
  provider = "postgresql"
}

model addresses {
  id      String  @id @db.Uuid
  user_id String? @unique @db.Uuid
  street  String?
  city    String?
  country String?
  users   users?  @relation(fields: [user_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
model cart_items {
  id         String    @id @db.Uuid
  cart_id    String?   @db.Uuid
  product_id String?   @db.Uuid
  quantity   Int
  carts      carts?    @relation(fields: [cart_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  products   products? @relation(fields: [product_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
}

model carts {
  id         String       @id @db.Uuid
  user_id    String?      @db.Uuid
  created_at DateTime?    @default(now()) @db.Timestamptz(6)
  cart_items cart_items[]
  users      users?       @relation(fields: [user_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
}

model categories {
  id                 String               @id @db.Uuid
  name               String
  product_categories product_categories[]
}

model order_items {
  id         String    @id @db.Uuid
  order_id   String?   @db.Uuid
  product_id String?   @db.Uuid
  price      Decimal?  @db.Decimal(10, 2)
  quantity   Int?
  orders     orders?   @relation(fields: [order_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  products   products? @relation(fields: [product_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
}

model orders {
  id          String        @id @db.Uuid
  user_id     String?       @db.Uuid
  total       Decimal?      @db.Decimal(10, 2)
  status      String?       @default("pending")
  created_at  DateTime?     @default(now()) @db.Timestamptz(6)
  order_items order_items[]
  users       users?        @relation(fields: [user_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  payments    payments[]
}

model payments {
  id       String    @id @db.Uuid
  order_id String?   @db.Uuid
  amount   Decimal?  @db.Decimal(10, 2)
  method   String?
  status   String?
  paid_at  DateTime? @db.Timestamptz(6)
  orders   orders?   @relation(fields: [order_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
}

model product_categories {
  product_id  String     @db.Uuid
  category_id String     @db.Uuid
  categories  categories @relation(fields: [category_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  products    products   @relation(fields: [product_id], references: [id], onDelete: Cascade, onUpdate: NoAction)

  @@id([product_id, category_id])
}

model products {
  id                 String               @id @db.Uuid
  name               String
  description        String?
  price              Decimal              @db.Decimal(10, 2)
  stock              Int?                 @default(0)
  created_at         DateTime?            @default(now()) @db.Timestamptz(6)
  photo              String?              @default("product_photo_default.webp")
  cart_items         cart_items[]
  order_items        order_items[]
  product_categories product_categories[]
}

model profiles {
  id            String    @id @db.Uuid
  name          String
  identity_code String
  birthdate     DateTime? @db.Date
  gender        String?   @db.Bit(1)
  phone1        String
  phone2        String?
  photo         String?   @default("user_photo_default.webp")
  user_id       String?   @unique @db.Uuid
  created_at    DateTime? @default(now()) @db.Timestamptz(6)
  users         users?    @relation(fields: [user_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
model testimonial_comments {
  id      String    @id @db.Uuid
  user_id String?   @db.Uuid
  message String
  star    Int
  status  String?
  paid_at DateTime? @db.Timestamptz(6)
  users   users?    @relation(fields: [user_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
}

model users {
  id                   String                 @id @db.Uuid
  email                String                 @unique
  password             String
  is_admin             Boolean                @default(false)
  is_active            Boolean                @default(true)
  created_at           DateTime?              @default(now()) @db.Timestamptz(6)
  addresses            addresses[]
  carts                carts[]
  orders               orders[]
  profiles             profiles[]
  testimonial_comments testimonial_comments[]
}
